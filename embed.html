<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Play · Buzzy Games</title>
  <meta name="theme-color" content="#0b0f14"/>
  <style>
    :root{ --bg:#0b0f14; --txt:#e6ebf5; --muted:#aab6ca; --glass:rgba(255,255,255,.06); }
    *{ box-sizing:border-box }
    html,body{ height:100%; }
    body{ margin:0; background:#0b0f14; color:var(--txt); font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }
    .bar{
      position:sticky; top:0; z-index:5; display:flex; align-items:center; gap:10px;
      padding:10px 12px; background:linear-gradient(180deg, rgba(11,15,20,.9), rgba(11,15,20,.6));
      border-bottom:1px solid rgba(255,255,255,.06); backdrop-filter: blur(8px);
    }
    .btn{ background:transparent; color:var(--txt); border:1px solid rgba(255,255,255,.12); border-radius:10px; padding:8px 12px; cursor:pointer; }
    .title{ font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .muted{ color:var(--muted); font-size:12px }
    .wrap{ position:fixed; inset:48px 0 0 0; display:flex; }
    #frame{ flex:1; border:none; background:#000; }
  </style>
</head>
<body>
  <div class="bar">
    <button class="btn" id="backBtn">← Home</button>
    <div class="title" id="title">Loading…</div>
    <div style="margin-left:auto; display:flex; gap:8px">
      <button class="btn" id="fsBtn" title="Fullscreen">Fullscreen</button>
    </div>
  </div>
  <div class="wrap">
    <iframe id="frame" allow="autoplay; fullscreen; gamepad; xr-spatial-tracking; accelerometer; magnetometer; gyroscope; clipboard-read; clipboard-write" sandbox="allow-scripts allow-same-origin allow-forms allow-pointer-lock allow-modals allow-popups" referrerpolicy="no-referrer"></iframe>
  </div>

  <script>
    const params = new URLSearchParams(location.search);
    const url = params.get('url') || '';
    const title = params.get('title') || 'Game';
    document.getElementById('title').textContent = title;
    const frame = document.getElementById('frame');

    // Defensive: block javascript: and data:text/html
    if (!/^https?:\/\//i.test(url)) {
      frame.srcdoc = `<div style="display:grid;place-items:center;height:100%;color:#e6ebf5"><div>Invalid or missing URL.</div><div class="muted">Got: ${String(url || '—')}</div></div>`;
    } else {
      frame.src = url;
    }

    document.getElementById('backBtn').onclick = () => history.length > 1 ? history.back() : (location.href = './index.html');

    document.getElementById('fsBtn').onclick = async () => {
      const el = document.documentElement;
      try{
        if (!document.fullscreenElement) await el.requestFullscreen();
        else await document.exitFullscreen();
      }catch(e){ console.warn(e); }
    };
  </script>
</body>
</html>
